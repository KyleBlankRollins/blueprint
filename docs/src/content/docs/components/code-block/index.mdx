---
title: Code Block
description: Display source code with syntax highlighting, copy-to-clipboard, and line numbers
---

import ComponentPreview from '../../../../components/ComponentPreview.astro';
import CodeBlock from '../../../../components/CodeBlock.astro';

export const examplesBase = 'src/content/docs/components/code-block/examples';

The `bp-code-block` component displays source code with features like copy-to-clipboard, line numbers, line highlighting, and expand/collapse for long blocks.

## Import

```javascript
import '@krollins/blueprint/code-block';
```

## Examples

### Basic

<ComponentPreview>
  <CodeBlock base={examplesBase} src="install.sh" />
</ComponentPreview>

```html
<bp-code-block
  language="bash"
  code="npm install @krollins/blueprint"
></bp-code-block>
```

### With Title

Use the `title` attribute to display a filename or label in the header.

<ComponentPreview>
  <CodeBlock base={examplesBase} src="greeting.ts" title="greeting.ts" />
</ComponentPreview>

```html
<bp-code-block
  language="typescript"
  title="greeting.ts"
  code="function greet(name: string): string {
  return `Hello, ${name}!`;
}"
></bp-code-block>
```

### With Line Numbers

<ComponentPreview>
  <CodeBlock base={examplesBase} src="lit-element.js" showLineNumbers />
</ComponentPreview>

```html
<bp-code-block
  language="javascript"
  show-line-numbers
  code="import { html, LitElement } from 'lit';
import { customElement } from 'lit/decorators.js';

@customElement('my-element')
export class MyElement extends LitElement {
  render() {
    return html`<p>Hello World</p>`;
  }
}"
></bp-code-block>
```

### No Line Wrapping

Disable line wrapping to enable horizontal scrolling for wide code.

<ComponentPreview>
  <CodeBlock base={examplesBase} src="long-line.js" wrapLines={false} />
</ComponentPreview>

```html
<bp-code-block
  language="javascript"
  wrap-lines="false"
  code="const veryLongVariableName = someFunction(argumentOne, argumentTwo, argumentThree, argumentFour, argumentFive);"
></bp-code-block>
```

### Collapsible

Use `max-lines` to collapse long code blocks with a "Show more" toggle.

<ComponentPreview>
  <CodeBlock base={examplesBase} src="tokens.css" title="tokens.css" showLineNumbers maxLines={5} />
</ComponentPreview>

```html
<bp-code-block
  language="css"
  title="tokens.css"
  show-line-numbers
  max-lines="5"
  code=":root {
  --bp-color-primary: #3b82f6;
  --bp-color-secondary: #64748b;
  --bp-color-success: #22c55e;
  --bp-color-warning: #f59e0b;
  --bp-color-error: #ef4444;
  --bp-spacing-sm: 0.5rem;
  --bp-spacing-md: 1rem;
  --bp-spacing-lg: 1.5rem;
  --bp-spacing-xl: 2rem;
  --bp-border-radius-sm: 0.25rem;
  --bp-border-radius-md: 0.5rem;
}"
></bp-code-block>
```

### Without Header

Hide the header bar entirely. The copy button floats over the code area instead.

<ComponentPreview>
  <CodeBlock base={examplesBase} src="hello.sh" showHeader={false} />
</ComponentPreview>

```html
<bp-code-block
  language="bash"
  show-header="false"
  code="echo 'Hello, world!'"
></bp-code-block>
```

### Without Copy Button

<ComponentPreview>
  <CodeBlock base={examplesBase} src="no-copy.txt" showCopyButton={false} />
</ComponentPreview>

```html
<bp-code-block
  language="text"
  show-copy-button="false"
  code="This block has no copy button."
></bp-code-block>
```

## Syntax Highlighting

The component uses a pluggable adapter pattern. The built-in `plainTextAdapter` renders monospace text with zero dependencies. You can set a custom adapter (e.g. Shiki) per-instance or globally:

```javascript
import { createShikiAdapter, BpCodeBlock } from '@krollins/blueprint/code-block';

// Set globally for all code blocks
BpCodeBlock.defaultAdapter = createShikiAdapter({
  langs: ['typescript', 'html', 'css'],
  theme: 'github-dark',
});
```

## Loading Code from Files

Passing multi-line code through the `code` attribute works, but it gets unwieldy fast — escaped backticks, template literals, and strings that are hard to read or maintain.

This docs site solves that with a thin Astro wrapper (`CodeBlock.astro`) that reads source files at build time and passes their contents to `bp-code-block`.

### How it works

1. Store each code example as a standalone file with the correct extension (e.g. `greeting.ts`, `install.sh`).
2. The wrapper reads the file at build time via `fs.readFileSync` and passes the content into the `code` attribute.
3. Language is inferred from the file extension — no need to specify it manually.

### Co-locating examples with pages

Example files live alongside the page that uses them. For this page, the structure looks like:

```
components/
  code-block/
    index.mdx             ← this page
    examples/
      greeting.ts
      tokens.css
      lit-element.js
      ...
```

Astro's content collection glob (`**/*.{md,mdx}`) only picks up Markdown files, so the `.ts`, `.css`, and `.js` example files are ignored by the content pipeline — they're just data files read at build time. A `generateId` function in the content config strips `/index` from the id so that `code-block/index.mdx` produces the route `/components/code-block/` as expected.

The `CodeBlock` wrapper accepts a `base` prop to tell it where to find the files:

```astro
---
import CodeBlock from '../components/CodeBlock.astro';

// Point to the co-located examples directory
export const examplesBase = 'src/content/docs/components/code-block/examples';
---

<!-- Language inferred from .sh extension -->
<CodeBlock base={examplesBase} src="install.sh" />

<!-- With additional props -->
<CodeBlock base={examplesBase} src="greeting.ts" title="greeting.ts" showLineNumbers />

<!-- Collapsible -->
<CodeBlock base={examplesBase} src="tokens.css" title="tokens.css" showLineNumbers maxLines={5} />
```

Pages that don't set `base` resolve from the default `src/examples/` directory, so existing usage is unaffected.

### Why this works well

- **Real files with real extensions** — your editor gives you syntax highlighting, linting, and formatting for free.
- **No escaping** — backticks, template literals, and special characters just work.
- **Co-location** — examples live next to the page that uses them, making it easy to see what belongs together.
- **Build-time only** — file reads happen during the static build. Zero runtime cost.

The wrapper is Astro-specific, but the same pattern works in any SSG or framework that supports build-time file reads. The key idea is that `bp-code-block` accepts code as a string — how you get that string to the component is up to you.

## API Reference

### Properties

| Property           | Attribute           | Type                        | Default            | Description                                                              |
| ------------------ | ------------------- | --------------------------- | ------------------ | ------------------------------------------------------------------------ |
| `code`             | `code`              | `string`                    | `''`               | The source code to display                                               |
| `language`         | `language`          | `string`                    | `'text'`           | Language identifier for syntax highlighting and header label             |
| `title`            | `title`             | `string`                    | `''`               | Optional title in the header (e.g. filename). Overrides language label   |
| `showLineNumbers`  | `show-line-numbers` | `boolean`                   | `false`            | Show line number gutter                                                  |
| `highlightLines`   | —                   | `number[]`                  | `[]`               | Array of 1-based line numbers to visually highlight                      |
| `wrapLines`        | `wrap-lines`        | `boolean`                   | `true`             | Wrap long lines instead of horizontal scroll                             |
| `showCopyButton`   | `show-copy-button`  | `boolean`                   | `true`             | Show the copy-to-clipboard button                                        |
| `maxLines`         | `max-lines`         | `number \| undefined`       | `undefined`        | Collapse to this many lines with a "Show more" toggle                    |
| `showHeader`       | `show-header`       | `boolean`                   | `true`             | Show/hide the header bar. When false, copy button floats over the code   |
| `highlightAdapter` | —                   | `CodeBlockHighlightAdapter` | `plainTextAdapter` | Pluggable syntax highlighting adapter. Set per-instance or as a default  |

### Events

| Event     | Detail                               | Description                                                                |
| --------- | ------------------------------------ | -------------------------------------------------------------------------- |
| `bp-copy` | `{ code: string, success: boolean }` | Fired after a copy attempt. `success` indicates clipboard write succeeded. |

### Slots

| Slot          | Description                                            |
| ------------- | ------------------------------------------------------ |
| `title`       | Custom title content. Overrides the `title` attribute. |
| `controls`    | Additional controls placed before the copy button.     |
| `copy-icon`   | Custom icon for the copy button (default state).       |
| `copied-icon` | Custom icon for the copy button (success state).       |

### CSS Parts

| Part            | Description               |
| --------------- | ------------------------- |
| `base`          | Outer wrapper             |
| `header`        | Header bar                |
| `title`         | Title text area           |
| `controls`      | Controls container        |
| `copy-button`   | The copy button           |
| `body`          | Scrollable code container |
| `pre`           | The `<pre>` element       |
| `code`          | The `<code>` element      |
| `line-number`   | Individual line number    |
| `line`          | Individual line of code   |
| `expand-button` | The show more/less button |

## Accessibility

- `role="region"` with `aria-label` including the title when set
- Semantic `<pre><code>` structure for screen readers
- Copy button has `aria-label` that updates on copy state
- `aria-live="polite"` region announces copy success/failure
- Line numbers are `aria-hidden="true"` (decorative)
- Expand button has `aria-expanded` attribute
- Keyboard: `Tab` to copy/expand buttons, `Enter`/`Space` to activate
